<form class="editor" role="form" method="POST" action="{{ session.urls.sites }}/{{ content.site.name }}" autocomplete="off" data-editor-form>
	<input type="hidden" name="_method" value="PUT"/>
	<input type="hidden" name="_action" value="theme"/>
	<input type="hidden" name="theme.id" value="{{ content.site.theme.id }}"/>
	<div class="editor-header">
		<div class="editor-header-controls">
			<button type="reset" class="btn btn-default mr5">Reset changes</button>
			<button type="submit" class="btn btn-success mr5">Save changes</button>
			<a href="{{ session.urls.sites }}/{{ content.site.name }}" class="p10" title="Back to site settings"><i class="fa fa-times"></i></a>
		</div>
		<div class="editor-header-title pull-left">
			<div class="brand">
				<h3 class="brand-logo"><a href="/">Shunt</a></h3>
			</div>
		</div>
	</div>
	<div class="editor-sidepanel" id="editor-sidepanel">
		<div class="panel panel-primary mb0">
			<div class="panel-heading">
				<div class="panel-controls">
					<a href="javascript:;" class="editor-sidepanel-toggle" data-toggle="collapse-sidepanel" data-target="#editor-sidepanel" aria-controls="editor-sidepanel">
						<i class="fa fa-bars"></i>
					</a>
				</div>
				<h4 class="editor-sidepanel-collapsed-title bg-white text-uppercase">Theme editor</h4>
				<h4 class="editor-sidepanel-title no-margin text-uppercase"><i class="fa fa-paint-brush mr10"></i> Theme editor</h4>
			</div>
			<div class="panel-body bordered-group">
				{{#each (lookup (lookup content.themes content.site.theme.id) 'config') as |configGroup|}}
				<fieldset class="form-group">
					<h4 class="text-uppercase mt0 mb0">{{ configGroup.label }}</h4>
					{{#each configGroup.fields as |field|}}
					<label class="control-label mt15">{{ field.label }}</label>
					{{#if (eq field.editor.name 'input')}}
					<input type="{{ field.editor.options.type }}" class="form-control"
						name="theme.config.{{ configGroup.name }}.{{ field.name }}"
						placeholder="{{ field.editor.options.placeholder }}"
						maxlength="{{ field.editor.options.maxLength }}"
						value="{{ lookup (lookup ../../content.site.theme.config configGroup.name) field.name }}"
					/>
					{{/if}}
					{{#if (eq field.editor.name 'textarea')}}
					<textarea class="form-control"
						name="theme.config.{{ configGroup.name }}.{{ field.name }}"
						placeholder="{{ field.editor.options.placeholder }}"
						maxlength="{{ field.editor.options.maxLength }}"
						rows="{{ field.editor.options.rows }}"
					>{{ escapeNewlines (lookup (lookup ../../content.site.theme.config configGroup.name) field.name) }}</textarea>
					{{/if}}
					{{#if (eq field.editor.name 'code')}}
					<textarea class="form-control code-editor"
						name="theme.config.{{ configGroup.name }}.{{ field.name }}"
						placeholder="{{ field.editor.options.placeholder }}"
						maxlength="{{ field.editor.options.maxLength }}"
						rows="{{ field.editor.options.rows }}"
						data-language="{{ field.editor.options.language }}"
					>{{ escapeNewlines (lookup (lookup ../../content.site.theme.config configGroup.name) field.name) }}</textarea>
					{{/if}}
					{{#if (eq field.editor.name 'colorpicker')}}
					<div class="input-group" data-colorpicker
						{{#if field.editor.options.format }}
						data-format="{{ field.editor.options.format }}"
						{{/if}}
						{{#if field.editor.options.presets }}
						data-color-selectors="{{ json field.editor.options.presets }}"
						{{/if}}
					>
						<input class="form-control"
							name="theme.config.{{ configGroup.name }}.{{ field.name }}"
							placeholder="{{ field.editor.options.placeholder }}"
							value="{{ lookup (lookup ../../content.site.theme.config configGroup.name) field.name }}"
						/><span class="input-group-addon no-bg">
							<i></i>
						</span>
					</div>
					{{/if}}
					{{/each}}
				</fieldset>
				{{/each}}
			</div>
		</div>
	</div>
	<div class="editor-main">
		<iframe class="editor-preview" src="{{ session.urls.preview }}/{{ content.site.name }}" frameborder="0" data-editor-preview></iframe>
		<div class="editor-loading form-centered center-block mb25">
			<h4 class="text-center mt5 mb25">
				<i class="form-centered-icon fa fa-cog fa-3 fa-spin"></i>
				<p>Building site previewâ€¦</p>
			</h4>
		</div>
	</div>
</form>
